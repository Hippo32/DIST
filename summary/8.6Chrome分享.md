## 页面的解析 ##
参考：[event loop中的Update the rendering（更新渲染）](https://github.com/Hippo32/DIST/blob/master/summary/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF.md#event-loop%E4%B8%AD%E7%9A%84update-the-rendering%E6%9B%B4%E6%96%B0%E6%B8%B2%E6%9F%93)

## 影响前端流畅度的因素（回流与重绘） ##
减少Render Tree的回流和重绘，主要需要处理的是回流问题

定义：

- 回流：Render Tree中的元素因为尺寸，布局，隐藏等改变而需要重新构建，这就叫做回流（reflow）。每个页面至少需要一次回流，就是在页面第一次加载的时候。
- 重绘：当Render Tree的一部分元素需要更新元素，而这些元素只是外观，风格，而不会影响布局的，比如background-color。则叫做重绘。
- 回流必将引起重绘，而重绘不一定会引起回流。

浏览器的优化策略：一般浏览器都会进行回流的优化处理，因为回流的代价比较大，所以如果每一个操作都需要进行回流处理，那么浏览器很容易承受不住，于是浏览器自身就进行了优化处理，将回流和重绘操作放置在一个队列中，在到达一定时间或者一定数量则进行批量的处理，这样将多次的回流和重绘操作减少称为一次的操作。

一些操作可能提前强制浏览器对队列进行flush，例如在向浏览器请求一些style信息时就可能造成队列flush。

1. 请求`offsetTop`、`offsetLeft`、`offsetWidth`、`offsetHeight`时
2. 请求`scrollTop`、`scrollLeft`、`scrollWidth`、`scrollHeight`
3. 请求`clientTop`、`clientLeft`、`clientWidth`、`clientHeight`
4. 请求`getComputedStyle()`计算样式时

因为请求一些属性时，浏览器为了给精确的值，队列中的一些操作可能会影响到这些值，那么即使获取元素的布局和样式信息更最近发生或者改变的布局信息无关，浏览器都会强行刷新渲染队列。


**减少回流的策略：**减少回流和重绘起始就是减少对Render Tree的操作，减少对一些style信息的请求，尽量利用浏览器的优化策略。

1. 减少dom元素的操作（变化dom的大小、位置）
2. 注意dom元素的创建、删除处理，可使用“离线处理”，处理完一起更新
	1. 使用DocumentFragment进行缓存操作，引发一次回流和重绘；
	2. 使用display:none技术，只引发两次回流和重绘；
	3. 使用cloneNode(true or false)和replaceChild技术，引发一次回流和重绘；
3. 少请求影响浏览器flush队列的style信息，多使用缓存（将offsetWidth等信息变量保存）
4. 让元素脱离动画流，减少回流的规模

## 请求过大 ##
解决方案

1. 使用缓存技术加快响应
2. 压缩文件减少容量
3. 减少请求，合并文件和图片
4. 使用json格式进行数据交互

## 内存泄漏 ##
原因

1. 监听在window/document/body等habdler事件没有解绑
2. 模块形成的闭包内部变量使用完后没有将引入变量设为null
3. 使用第三方库创建，没有调用正确的销毁函数
4. dom的移除若子节点存在引用则无法回收
5. widget使用事件的订阅，在摧毁时没有移除

解决方案

1. 注意dom元素的对象引用（删除父节点时，先将子节点引用移除）
2. 事件的绑定注意解绑操作
3. 减少反复重写属性
4. 闭包函数使用注意引用清除
## 基本工具 ##
1. Elements面板
	
	右侧面板主要可对dom节点进行增加、删除、修改。

	右侧面板主要可对dom节点的样式进行修改，模型进行、绑定事件进行查看。
2. Console面板

	主要是用于记录的诊断，JavaScript交互，消息的堆叠等。

	当需要换到下一行而不是回车的时候，请按`Shift+Enter`
3. Source面板

	主要是用于资源文件查看、断点调试，事件的监听等。
4. Network面板

	主要是用于网络加载分析，可进行文件、接口请求的信息查看，信息包括文件信息、返回结果、请求事件等，可以根据这个进行网络性能优化。
5. Performance面板

	主要是用于页面性能分析，可进行页面状态、事件、运行、内存查看，通过页面查看性能情况，进行分析定位。

	- fps显示：可以看到最上面绿色显示界面流畅度比较良好，而红色界面卡顿严重
	- cpu处理显示：不同颜色表示在不同阶段cpu进行处理所花费的时间
	- 快照图片显示：显示在不同阶段界面上的呈现情况图片
	- 过程事件展示：在过程中事件所花费的长短，横向表示时间，纵向表示调用栈
	- 汇总信息：可以看出这段时间少的处理花费时间，事件的日志记录，事件调用栈等

	在Performance中已经可以完成大多数的性能检测定位。而在其中Memory进行详细分析处理内存泄漏问题处理。
6. Memory

	主要是用于深度性能分析，提供记录场景运行、记录堆快照、记录堆分配等三个功能实现对渲染性能和内存泄漏的分析定位。

	对游离的dom元素进行分析判断，在类的部分进行检索Detached，可以检索到脱离Dom树的节点。进行查看之后，红色代表着内存的泄露，黄色代表着泄露的对象引用对象。
7. Security面板

	通过该面板进行当前网页的安全认证并且网站正确实现HTTPS协议，可查看指定源的连接。
8. Application面板

	主要是用于记录网站加载的资源信息，包括存储数据、缓存数据、字体、图片、脚本、样式等，可通过Frame窗口进行查看资源。
9. Audits面板

	对当前网页进行网络分析，诊断并给一定的优化建议，例如没有用到的资源、可合成的资源、利用缓存等。