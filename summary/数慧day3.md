# 数慧day3 #
2018/7/25 9:05:53 

今天任务：

- 把dojo看完

## dojo/query ##
`query`始终返回一个与选择器匹配的节点数组。这个数组实际上是一个`dojo/NodeList`并且具有与包含在其中的节点交互的方法

当`query`没有第二个参数执行时，它将搜索整个DOM结构，有效地遍历每个节点。将DOM节点指定为第二个参数时，它会将查询限制为该节点及其子节点。

`NodeList`具有与Dojo数组辅助方法匹配的方法。一种这样的方法是`forEach`，它将为数组中的每个节点执行一个函数。

## dojo事件 ##
- `on(element,event name,handler)`：即on(元素，事件名称，处理程序）。或者，换句话说，对于此元素上的此事件，请连接此处理程序。此模式使用于所有窗口，文档，节点，表单，鼠标和键盘事件。
- `dojo/on`处理事件
- `dojo/aspect`通知函数
- on方法事件处理程序的工作方式：
	- 事件处理程序始终按其注册顺序调用
	- 始终使用事件对象作为第一个参数调用它们。
	- 事件对象将始终规范化以包括常见的W3C事件对象属性，包括`target`属性，`stopPropagation`方法和`preventDefault`方法等。
- 删除事件侦听器：
	
		var handle = on(myButton, "click", function(evt) {
			handle.remove();
		});
	- `on.once`：接受与`on`相同的参数，但会在触发后自动删除处理程序。
- 默认情况下：`on`将在第一个参数中传递的节点的上下文中运行事件处理程序。
- 与`dojo.connect`不同，`on`不接受处理程序范围和方法参数。如果您希望保留执行上下文，则需要把`lang.hitch`作为第三个参数。
- 给NodeList添加事件
- 事件委托：由于时间的冒泡，我们点击子元素的时候，会把事件一层层的传递给父级元素。相反的，我们操作元素的时候，直接把事件绑定在父级元素上，而不是分别给子元素绑定事件。通过判断子元素，从而达到同样的效果，这就是所谓的“事件委托”
	- `on(parent element, "selector: event name", handler)`
	- 需要注意的是，需要引入`dojo/query`，但是不直接使用它，因为`dojo/on`需要`dojo/query`才能匹配用于事件委托的选择器。
	- this仍然引用我们感兴趣的实际节点，而不是parentDiv节点。即this不再引用作为第一个参数传递的节点，而是指向选择器匹配的节点。
- 发布/订阅`dojo/topic`
	- 通过`dojo/topic`模块，Pub/Sub允许你为一个主题注册一个处理器（主题是一个事件的别名，此事件是多源的，以字符串形式描述）当发布的时候主题将被调用。
	- 订阅/发布模式是靠主题和事件处理函数联系起来的。如果你想停止接受主题，topic.subscribe方法返回一个对象，该对象具有remove方法，可以用来删除相应的处理程序。
	- `topic.subscribe`：用于订阅消息，接收两个参数，第一参数为要订阅的消息名字（唯一标识），如"socket/msg_arrive"，第二参数为回调函数。subscribe返回一个句柄，该句柄的remove方法用于取消订阅。
	- `topic.publish`：用于发布消息，接收任意多个参数，第一参数为要发布的信息名字（唯一标识），如"socket/msg_arrive"，其他参数为传递给订阅回调函数的参数。

## dojo/_base/lang ##
每当在JS中调用函数时，都会创建一个执行上下文。使用以下过程创建此上下文：

- 创建参数对象
- 创建功能范围
- 函数变量实例化
- this属性（上下文）创建

范围：

- 一方面：它可能意味着调用（或执行）某事物的对象
- 另一方面：它是定义某事物的对象（词法范围）

### `lang.hitch` ###
- lang.hitch确保始终调用绑定到执行上下文的特定函数，而不必担心在运行时切换该上下文。

### `lang.partial` ###
使用lang.partial控制参数列表

`lang.partial`是一个返回值为函数的函数，可以用预定义的值锁定函数的前几个参数。